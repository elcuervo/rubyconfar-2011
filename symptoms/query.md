
SELECT SUM(offerTotal) as theOfferTotal, SUM(lienTotal) AS theLienTotal, SUM(CLVtotal) AS theCLVtotal, SUM(estGrossProfitTotal) AS theESTGPtotal FROM (( SELECT COALESCE(SUM(COALESCE(offerAmount, 0)), 0) AS offerTotal, COALESCE(SUM(COALESCE(amount, 0) + COALESCE(legalFees, 0) + COALESCE(costs, 0)), 0) AS lienTotal, COALESCE(SUM(((amount + legalFees + costs) * (1 + (rateOfInterest / 100) * (FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(dateOfAttachment)) / 86400) / 365)))), 0) AS CLVtotal, COALESCE(SUM((((amount + legalFees + costs) * (1 + (rateOfInterest / 100) * (FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(dateOfAttachment)) / 86400) / 365))) - COALESCE(offerAmount, 0))), 0) AS estGrossProfitTotal FROM lienTable AS theLienTable, propertyTable, property_lien, stateInterestTable, data, judgementLienTable WHERE theLienTable.lienID = property_lien.lienID AND propertyTable.propertyID = property_lien.propertyID AND propertyTable.state = stateInterestTable.state AND theLienTable.lienID = judgementLienTable.lienID AND theLienTable.lienStatusID IN (65, 70, 75) AND data.id = (SELECT data.id FROM lienTable, data, data_lien WHERE lienTable.lienID = data_lien.lienID AND data_lien.id = data.id AND category = 15 AND lienTable.lienID = theLienTable.lienID ORDER BY data.id DESC LIMIT 1) AND dateOfAttachment != 0 AND UNIX_TIMESTAMP(NOW()) > UNIX_TIMESTAMP(dateOfAttachment) AND FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(dateOfAttachment)) / 86400) > 0 AND rateOfInterest > 0 ) UNION ( SELECT COALESCE(SUM(COALESCE(offerAmount, 0)), 0) AS offerTotal, COALESCE(SUM(COALESCE(amount, 0) + COALESCE(legalFees, 0) + COALESCE(costs, 0)), 0) AS lienTotal, COALESCE(SUM(((amount + legalFees + costs) * (1 + (rateOfInterest / 100) * (FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(judgementDate)) / 86400) / 365)))), 0) AS CLVtotal, COALESCE(SUM((((amount + legalFees + costs) * (1 + (rateOfInterest / 100) * (FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(dateOfAttachment)) / 86400) / 365))) - COALESCE(offerAmount, 0))), 0) AS estGrossProfitTotal FROM lienTable AS theLienTable, propertyTable, property_lien, stateInterestTable, data, judgementLienTable WHERE theLienTable.lienID = property_lien.lienID AND propertyTable.propertyID = property_lien.propertyID AND propertyTable.state = stateInterestTable.state AND theLienTable.lienID = judgementLienTable.lienID AND theLienTable.lienStatusID IN (65, 70, 75) AND data.id = (SELECT data.id FROM lienTable, data, data_lien WHERE lienTable.lienID = data_lien.lienID AND data_lien.id = data.id AND category = 15 AND lienTable.lienID = theLienTable.lienID ORDER BY data.id DESC LIMIT 1) AND COALESCE(dateOfAttachment, 0) = 0 AND judgementDate != 0 AND UNIX_TIMESTAMP(NOW()) > UNIX_TIMESTAMP(judgementDate) AND FLOOR((UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(judgementDate)) / 86400) > 0 AND rateOfInterest > 0 ) ) AS theBigTable;
